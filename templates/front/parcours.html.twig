{% extends 'front/base.html.twig' %}

{% block title %}Ajouter un Parcours - MentorAI
{% endblock %}

{% block body %}
	<!-- Page Title -->
	<div class="page-title accent-background py-5" style="background: linear-gradient(135deg, #102c59 0%, #0a1d3d 100%);">
		<div class="container text-center text-white">
			<h1 class="display-4 fw-bold mb-2">Nouveau Parcours</h1>
			<p class="lead opacity-75">Enregistrez vos formations et expériences pour enrichir votre profil.</p>
		</div>
	</div>

	<section class="section py-5">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-lg-8">

					{% for message in app.flashes('success') %}
						<div class="alert alert-success alert-dismissible fade show rounded-4 border-0 shadow-sm mb-4 py-3" role="alert">
							<div class="d-flex align-items-center">
								<i class="bi bi-check-circle-fill me-3 fs-4"></i>
								<div>
									<h6 class="mb-0 fw-bold">Félicitations !</h6>
									<span>{{ message }}</span>
								</div>
							</div>
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
						</div>
					{% endfor %}

					<div class="card shadow-lg border-0 rounded-4 overflow-hidden">
						<div class="card-header py-4 px-5 border-0" style="background-color: #f8faff; border-bottom: 3px solid #d52e28 !important;">
							<div class="d-flex align-items-center">
								<div class="icon-box me-3 rounded-circle d-flex align-items-center justify-content-center" style="width: 50px; height: 50px; background-color: rgba(16, 44, 89, 0.1);">
									<i class="bi bi-mortarboard-fill fs-4" style="color: #102c59;"></i>
								</div>
								<h3 class="mb-0 fw-bold" style="color: #102c59;">Formulaire de Saisie</h3>
							</div>
						</div>

						<div class="card-body p-5 pt-4">
							{{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}

							<div
								class="row g-4">
								<!-- Titre -->
								<div class="col-12">
									<label class="form-label fw-bold" style="color: #102c59;">Titre du Parcours
										<span class="text-danger">*</span>
									</label>
									<div class="input-group">
										<span class="input-group-text bg-white border-end-0 text-muted">
											<i class="bi bi-pencil"></i>
										</span>
										{{ form_widget(form.titre, {'attr': {'class': 'form-control border-start-0 ps-0 py-2', 'placeholder': 'Ex: Master en Intelligence Artificielle'}}) }}
									</div>
									<div class="text-danger small mt-1">{{ form_errors(form.titre) }}</div>
								</div>

								<!-- Type et Diplôme -->
								<div class="col-md-6">
									<label class="form-label fw-bold" style="color: #102c59;">Type de Parcours
										<span class="text-danger">*</span>
									</label>
									{{ form_widget(form.type_parcours, {'attr': {'class': 'form-control py-2', 'placeholder': 'Ex: Formation, Stage, Emploi'}}) }}
									<div class="text-danger small mt-1">{{ form_errors(form.type_parcours) }}</div>
								</div>
								<div class="col-md-6">
									<label class="form-label fw-bold" style="color: #102c59;">Diplôme / Certification
										<span class="text-danger">*</span>
									</label>
									{{ form_widget(form.diplome, {'attr': {'class': 'form-control py-2', 'placeholder': 'Ex: Bac +5, Certificat Google'}}) }}
									<div class="text-danger small mt-1">{{ form_errors(form.diplome) }}</div>
								</div>

								<!-- Établissement -->
								<div class="col-12">
									<label class="form-label fw-bold" style="color: #102c59;">Établissement / Organisme
										<span class="text-danger">*</span>
									</label>
									<div class="input-group">
										<span class="input-group-text bg-white border-end-0 text-muted">
											<i class="bi bi-building"></i>
										</span>
										{{ form_widget(form.etablissement, {'attr': {'class': 'form-control border-start-0 ps-0 py-2', 'placeholder': 'Ex: Esprit, Université de Tunis...'}}) }}
									</div>
									<div class="text-danger small mt-1">{{ form_errors(form.etablissement) }}</div>
								</div>

								<!-- Dates -->
								<div class="col-md-6">
									<label class="form-label fw-bold" style="color: #102c59;">Date de Début</label>
									{{ form_widget(form.date_debut, {'attr': {'class': 'form-control py-2'}}) }}
									<div class="text-danger small mt-1">{{ form_errors(form.date_debut) }}</div>
								</div>
								<div class="col-md-6">
									<label class="form-label fw-bold" style="color: #102c59;">Date de Fin</label>
									{{ form_widget(form.date_fin, {'attr': {'class': 'form-control py-2'}}) }}
									<div class="text-danger small mt-1">{{ form_errors(form.date_fin) }}</div>
								</div>

								<!-- Projets -->
								<div class="col-12">
									<label class="form-label fw-bold" style="color: #102c59;">Projets Associés</label>
									{{ form_widget(form.projets, {'attr': {'class': 'form-select py-2', 'style': 'height: 120px;'}}) }}
									<div class="form-text text-muted">
										<i class="bi bi-info-circle me-1"></i>
										Maintenez
										<kbd>Ctrl</kbd>
										+ Clic pour lier plusieurs projets à ce parcours.
									</div>
								</div>

								<!-- Description -->
								<div class="col-12">
									<label class="form-label fw-bold" style="color: #102c59;">Description détaillée
										<span class="text-danger">*</span>
									</label>
									{{ form_widget(form.description, {'attr': {'class': 'form-control', 'rows': '4', 'placeholder': 'Résumez vos acquis durant ce parcours...'}}) }}
									<div class="text-danger small mt-1">{{ form_errors(form.description) }}</div>
								</div>
							</div>

							{# Champs masqués pour éviter les erreurs de mapping si présents dans le type #}
							<div class="d-none">
								{% if form.specialite is defined %}
									{{ form_row(form.specialite) }}
								{% endif %}
								{% if form.entreprise is defined %}
									{{ form_row(form.entreprise) }}
								{% endif %}
								{% if form.poste is defined %}
									{{ form_row(form.poste) }}
								{% endif %}
								{% if form.type_contrat is defined %}
									{{ form_row(form.type_contrat) }}
								{% endif %}
							</div>

							<div class="row mt-5">
								<div class="col-md-6 mb-3 mb-md-0">
									<a href="{{ path('front_home') }}" class="btn btn-outline-secondary w-100 py-3 rounded-3 fw-bold">
										<i class="bi bi-arrow-left me-2"></i>Retour à l'accueil
									</a>
								</div>
								<div class="col-md-6">
									<button type="submit" class="btn text-white w-100 py-3 rounded-3 fw-bold shadow transition-all" style="background-color: #102c59; border: none;">
										<i class="bi bi-save-fill me-2"></i>Valider le Parcours
									</button>
								</div>
							</div>

							{{ form_end(form) }}
						</div>
					</div>

					<!-- Aide/Info -->
					<div class="mt-4 text-center">
						<p class="text-muted small">
							<i class="bi bi-shield-lock me-1"></i>
							Vos données sont sécurisées et validées selon les normes MentorAI.
						</p>
					</div>
				</div>
			</div>
		</div>
	</section>

	<style>
		.form-control,
		.form-select {
			border: 1px solid #dee2e6;
			transition: all 0.2s ease-in-out;
		}
		.form-control:focus,
		.form-select:focus {
			border-color: #9dbbce !important;
			box-shadow: 0 0 0 0.25rem rgba(157, 187, 206, 0.2) !important;
			background-color: #fff !important;
		}
		.btn:hover {
			transform: translateY(-2px);
			filter: brightness(1.1);
		}
		.transition-all {
			transition: all 0.3s ease;
		}
		.icon-box {
			transition: transform 0.3s ease;
		}
		.card:hover .icon-box {
			transform: rotate(10deg);
		}
	</style>
{% endblock %}
